legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
subgrp <- read_csv("output/likely_substrate_for_mds.csv")
is.na(subgrp$substrate_group)
clusviz <- cluster.visualize(apset, clusters, size.cutoff=1, quiet = TRUE)
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
clusviz <- cluster.visualize(apset, clusters, size.cutoff=1, quiet = TRUE)
subgrp <- read_csv("output/likely_substrate_for_mds.csv")
is.na(subgrp$substrate_group)
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
subgrp <- read_csv("output/likely_substrate_for_mds.csv")
is.na(subgrp$substrate_group)
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
clusviz <- cluster.visualize(apset, clusters, size.cutoff=1, quiet = TRUE)
# Install packages
pacman::p_load("webchem", "readxl", "tidyverse", "ChemmineR", "data.table", "plot3D", "plot3Drgl",
"ggrepel")
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel(subgrp$likely_substrate)
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel(subgrp$likely_substrate) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel(aes(x = x,y =y, subgrp$likely_substrate)) +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
subgrp$
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 5, height = 5)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
subgrp$
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 10, height = 10)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
subgrp$
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 10, height = 10)
par(mar=c(0.01, 0.01, 0.01, 0.01))
subgrp$
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 10, height = 10)
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 10, height = 10)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 2) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 20, height = 20)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 3) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 15, height = 15)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 3) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 3) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_labeled.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 3) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 3) +
scale_shape(solid = TRUE) +
#geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=10, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
#geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 14)
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
#geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 14),
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_colored.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
#geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 20),
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
pdf(paste0("output/", numseqs,"_PCoA_labeled.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 20),
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
subgrp[grepl("carboline", subgrp$likely_substrate)] <- ""
subgrp$likely_substrate[grepl("carboline", subgrp$likely_substrate)] <- ""
pdf(paste0("output/", numseqs,"_PCoA_labeled.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 20),
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
subgrp$likely_substrate[grepl("carboline|naphthoate", subgrp$likely_substrate)] <- ""
pdf(paste0("output/", numseqs,"_PCoA_labeled.pdf"), width = 12, height = 12)
par(mar=c(0.01, 0.01, 0.01, 0.01))
ggplot(data = subgrp, aes(x=x, y=y, label = likely_substrate)) +
# geom_text(label = trdat$nms) +
# geom_text(x = cdat$x, y = cdat$y, label = cdat$labl, check_overlap = T) +
geom_point() +
geom_point(aes(fill = as.factor(subgrp$substrate_group)), shape = 21, size = 4) +
scale_shape(solid = TRUE) +
geom_text_repel() +
# labs(x=xlab,y=ylab) +
theme_bw() +
theme(axis.text = element_text(size = 14),
legend.key = element_rect(fill = "white"),
legend.background = element_rect(fill = "white"),
legend.position = "top",
legend.box = "horizontal",
legend.text = element_text(size = 20),
legend.title = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title=element_text(size=14, face="bold", hjust=0))
dev.off()
